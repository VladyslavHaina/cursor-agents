---
description: "Helm chart standards (minimal values, predictable templates, safe upgrades)"
globs:
  - "**/Chart.yaml"
  - "**/values.yaml"
  - "**/templates/**/*.yml"
  - "**/templates/**/*.yaml"
  - "**/charts/**"
alwaysApply: false
---

## Helm

- GitOps-aware by default:
  - If Argo CD/Flux manages the release, prefer Git changes and controller sync over imperative `helm upgrade` in production.

- Values minimalism:
  - Expose only high-level knobs (replicas, image tag, resources, env overrides).
  - Do not template internal ConfigMaps unless required for environment injection.

- Template hygiene:
  - Keep templates readable; avoid excessive helper indirection.
  - Use standard labels and selectors.
  - Avoid surprising defaults; document non-obvious behaviors.

- Upgrade safety:
  - Make changes compatible with `helm upgrade` (immutable fields awareness).
  - If schema changes are needed, call out migration/rollback steps.
  - Call out CRD behavior explicitly when relevant (Helm v3 does not upgrade CRDs on normal upgrades).

- Verification:
  - Provide `helm template` / `helm lint` (when available) and a basic render check.
  - When possible, include a diff (`helm diff upgrade`, if available) or an upgrade dry-run (`helm upgrade --dry-run --debug`) before applying.
